<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>حاسبة النسبة</title>
<style>
body {
    font-family: Tahoma, Arial, sans-serif;
    background: #f5f5f5;
    padding: 30px;
}
.box {
    background: #fff;
    padding: 20px;
    max-width: 400px;
    margin: auto;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,.1);
}
input {
    width: 100%;
    padding: 10px;
    font-size: 16px;
    margin-bottom: 15px;
}
.result {
    margin-top: 15px;
    font-size: 18px;
    font-weight: bold;
    background: #eee;
    padding: 10px;
    border-radius: 6px;
}
</style>
</head>
<body>

<div class="box">
    <h3>أدخل السعر</h3>
    <input type="number" id="price" placeholder="مثال: 120">
    <div class="result" id="result">النسبة: - | القيمة: -</div>
</div>

<script>
const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRLGxxIqrjl0big4j4s2B9rvxEBTZ4ZqoyCDksCCPZXNpiEii_mSbSasgKZAYMlSA/pub?gid=237098079&single=true&output=csv";

let rules = [];

// تحميل البيانات من Google Sheets
fetch(sheetURL)
.then(res => res.text())
.then(csv => {
    const rows = csv.trim().split("\n").slice(1);
    rules = rows.map(r => {
        const c = r.split(",");
        return {
            from: Number(c[0]),
            to: Number(c[1]),
            rate: Number(c[2])
        };
    });
});

// حدث عند إدخال السعر
document.getElementById("price").addEventListener("input", function () {
    const price = Number(this.value);
    const rule = rules.find(r => price >= r.from && price <= r.to);

    if (rule) {
        const value = price * rule.rate;
        document.getElementById("result").innerHTML =
            `النسبة: ${(rule.rate * 100).toFixed(2)}%<br>القيمة: ${value.toFixed(2)}`;
    } else {
        document.getElementById("result").innerText = "خارج النطاق";
    }
});
</script>

</body>
</html>
